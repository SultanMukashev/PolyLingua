<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sync Audio and Video</title>
</head>
<body>
    <video id="video" controls>
        Your browser does not support the video tag.
    </video>

    <audio id="audio" controls>
        Your browser does not support the audio tag.
    </audio>

    <button id="loadData">Load Data</button>

    <script>
        // window.addEventListener('DOMContentLoaded', () => {
        //     const video = document.getElementById('video');
        //     const audio = document.getElementById('audio');
        //     const loadDataButton = document.getElementById('loadData');

        //     loadDataButton.addEventListener('click', async () => {
        //         // Simulate fetching video and audio sources from server
        //         const videoSrc = 'https://storage.cloud.google.com/polylingua-videos/How%20To%20Finish%20Programming%20Projects.mp4'; // Replace with actual video source
        //         const audioSrc = 'https://storage.cloud.google.com/polylingua-videos/inputAudio.mp3'; // Replace with actual audio source

        //         // Set video and audio sources
        //         video.src = videoSrc;
        //         audio.src = audioSrc;

        //         // Wait for metadata to be loaded for both audio and video
        //         await Promise.all([
        //             new Promise(resolve => video.addEventListener('loadedmetadata', resolve)),
        //             new Promise(resolve => audio.addEventListener('loadedmetadata', resolve))
        //         ]);

        //         // Get durations of video and audio
        //         const videoDuration = video.duration;
        //         const audioDuration = audio.duration;
        //         console.log(videoDuration);
        //         console.log(audioDuration);

        //         // Calculate the ratio of durations
        //         const rate = videoDuration / audioDuration;
        //         console.log(rate);
        //         // Set the playback rate of the audio element
        //         audio.playbackRate = rate;

        //         // Optionally, play both video and audio
                // video.play();
                // audio.play();
        //     });
        // });
        // function syncAudioWithVideoTime() {
        // // Get the current time scrolled in the video
        //     const videoTimeScrolled = (video.currentTime / video.duration) * video.scrollWidth;
        
        //     // Map video time scrolled to audio time (assuming audio duration is equal to video duration)
        //     const audioTime = (videoTimeScrolled / video.scrollWidth) * audio.duration;
        
        //     // Set audio playback position
        //     audio.currentTime = audioTime;
        // }
        
        // Add scroll event listener to sync audio with video time scrolled
        // video.addEventListener('timeupdate', syncAudioWithVideoTime);
//         document.addEventListener("DOMContentLoaded", function() {
//     var video = document.getElementById('video');
//     var audio = document.getElementById('audio');
//     var isSeeking = false; // Flag to track if user is seeking
    
//     // Function to synchronize playback
//     function synchronizePlayback() {
//         var durationRatio = video.duration / audio.duration;
        
//         // Adjust playback rate
//         video.playbackRate = durationRatio;
        
//         // Monitor changes in video currentTime to sync with audio
//         video.addEventListener('timeupdate', function() {
//             if (!isSeeking) {
//                 audio.currentTime = video.currentTime / durationRatio;
//             }
//         });
        
//         // Listen for user seeking
//         video.addEventListener('seeking', function() {
//             isSeeking = true;
//         });
        
//         // Listen for user seeked
//         video.addEventListener('seeked', function() {
//             isSeeking = false;
//             audio.currentTime = video.currentTime / durationRatio;
//         });
//     }
    
//     // Wait for metadata to be loaded for both elements
//     video.addEventListener('loadedmetadata', synchronizePlayback);
//     audio.addEventListener('loadedmetadata', synchronizePlayback);
// });

        </script>
        <script>
            const loadDataButton = document.getElementById('loadData');

            loadDataButton.addEventListener('click', async () => {
                // Simulate fetching video and audio sources from server
                const videoSrc = 'https://storage.cloud.google.com/polylingua-videos/How%20To%20Finish%20Programming%20Projects.mp4'; // Replace with actual video source
                const audioSrc = 'https://storage.cloud.google.com/polylingua-videos/inputAudio.mp3'; // Replace with actual audio source

                // Set video and audio sources
                video.src = videoSrc;
                audio.src = audioSrc;
                video.play();
                audio.play();
            })
            document.addEventListener("DOMContentLoaded", function() {
                var video = document.getElementById('videoPlayer');
                var audio = document.getElementById('audioPlayer');
                var isSeeking = false; 

                function synchronizePlayback() {
                    var durationRatio = video.duration / audio.duration;
                    var playbackRate = 1; 

                    if (durationRatio !== 1) {
                        playbackRate = durationRatio;
                        audio.playbackRate = playbackRate;
                    }
                    video.addEventListener('seeking', function() {
                        console.log('Seeking');
                        isSeeking = true;
                    });

                    // Listen for user seeked
                    video.addEventListener('seeked', function() {
                        console.log('Seeked');
                        isSeeking = false;
                        audio.currentTime = video.currentTime / playbackRate;
                    });
                }

                // Wait for metadata to be loaded for both elements
                video.addEventListener('loadedmetadata', synchronizePlayback);
                audio.addEventListener('loadedmetadata', synchronizePlayback);
            });

        </script>
</body>
</html>
